% Clearing within local economy and with rest of world


!variables

    "Net Investment Position to GDP Ratio" NIP_NGDP
    "Net investment position to GDP ratio adjusted for equity flows" NIP_NGDP_adj
    "Real commodity exports" Q
    "Total demand for investment goods" I
    "Total demand for consumption goods" C

    "Exports to GDP ratio" PxX_NGDP
    "Imports to GDP Ratio" PmM_NGDP
    "Nominal GDP" NGDP
    "Nominal GDP excluding commodity sector" NGDPx
    "Gross rate of change in real exports" dX
    "Gross rate of change in real imports" dM
    "Gross rate of change in real GDP" dGDP
    "Gross rate of change in real GDP excluding commodity sector" dGDPx

    "Private consumption to GDP ratio" PcCh_NGDP
    "Investment to GDP ratio" PiI_NGDP
    "Wage bill to GDP ratio" WN_NGDP

    "Value Added in Local Production Sector to GDP Ratio" VAy_NGDP
    "Value added in local production sector per capital" VAy_PkyKy
    "Wage bill to value-added ratio in local sector" WNy_VAy
    "Trade Balance to GDP Ratio" TB_NGDP

    "Nominal GDP excluding primary exports to nominal GDP ratio" NGDPx_NGDP

    "Consumer Real Exchange Rate" RER



!log-variables !all-but

    NGDPx_NGDP
    NIP_NGDP
    NIP_NGDP_adj
    PcCh_NGDP
    PiI_NGDP
    PmM_NGDP
    PxX_NGDP
    TB_NGDP
    VAy_NGDP
    VAy_PkyKy
    WN_NGDP
    WNy_VAy



!equations

% __Market clearing and aggregation__


    "Total demand for investment goods"
    I = Iy + Ig + Ih + Iz;

    "Total demand for consumption goods"
    C = Ch + Cg;

    "Local production breakdown"
    Y = C + I;


% __Exports and imports__

    PmM_NGDP*NGDP = Pmy*My + Pmz*Mz;

    PxX_NGDP*NGDP = (Pq*Q + Pz*Z);

% __International investment position / BOP__

    NIP_NGDP = BWh_NGDP + Bwf_NGDP - BGw_NGDP;
    NIP_NGDP_adj = NIP_NGDP;

    BWh_NGDP + Bwf_NGDP - BGw_NGDP = ...
        + Rw_star{-1}*S/S{-1}*BWh_NGDP{-1}/dNGDP ...
        + Rw_star{-1}*S/S{-1}*Bwf_NGDP{-1}/dNGDP ...
        - Rg_star{-1}*S/S{-1}*BGw_NGDP{-1}/dNGDP ...
        - TFw_NGDP ...
        - PIEw_NGDP ...
        + PxX_NGDP ...
        - PmM_NGDP ...
    ;


% __Nominal GDP__

    "Nominal GDP"
    % NGDP = (PcCh_NGDP + PgG_NGDP + PiI_NGDP + PxX_NGDP - PmM_NGDP)*NGDP;
    1 = PcCh_NGDP + PgG_NGDP + PiI_NGDP + PxX_NGDP - PmM_NGDP;

    "Nominal GDP excluding primary value added"
    NGDPx = NGDP - VAq_NGDP*NGDP;

    "Gross rate of change in real exports"
    dX = ...
        + movavg(PqQ_NGDP/PxX_NGDP, -2) * Q/Q{-1} ...
        + movavg(PzZ_NGDP/PxX_NGDP, -2) * Z/Z{-1} ...
    !! dX = ss_dA;


    "Gross rate of change in real imports"
    dM = ...
        + movavg(PmyMy_NGDP/PmM_NGDP, -2) * My/My{-1} ...
        + movavg(PmzMz_NGDP/PmM_NGDP, -2) * Mz/Mz{-1} ...
    !! dM = ss_dA;


    "Gross rate of change in real GDP"
    dGDP = ...
        + movavg(PcCh_NGDP, -2) * Ch/Ch{-1} ...
        + movavg(PgG_NGDP, -2) * G/G{-1} ...
        + movavg(PiI_NGDP, -2) * I/I{-1} ...
        + movavg(PxX_NGDP, -2) * dX ...
        - movavg(PmM_NGDP, -2) * dM ...
    !! dGDP = ss_dA;


    "Gross rate of change in real GDP exluding primary value added"
    dGDPx = ...
        + movavg(NGDP/NGDPx, -2) * dGDP ...
        - movavg(VAq_NGDP*NGDP/NGDPx, -2) * Q/Q{-1} ...
    !! dGDPx = ss_dA;


    PcCh_NGDP = Pc*Ch / NGDP;

    PiI_NGDP = Pi*I / NGDP;

    WN_NGDP = WNy_NGDP + WNz_NGDP + WNg_NGDP;

    "Nomial GDP excluding primary exports to nominal GDP ratio"
    NGDPx_NGDP * NGDP = NGDPx;

    VAy_NGDP = (Pc*Ch + PcCg_NGDP*NGDP + Pi*I - Pmy*My) / NGDP;

    VAy_PkyKy = VAy_NGDP / PkyKy_NGDP;

    WNy_VAy = WNy_NGDP / VAy_NGDP;

    "Trade balance to GDP"
    TB_NGDP = PxX_NGDP - PmM_NGDP;

    "Consumer real exchange rate"
    RER = S*Pw_star / Pc;


